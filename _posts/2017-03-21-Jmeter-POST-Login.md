---
layout: post
published: false
title: 'HOW TO: Record HTTP requests and login via JMETER'
---


In this tutorial we will learn how to successfully send a POST request using Jmeter in order to achieve a valid login to our web application.  For this article I will be using my open source web application which can be found here: https://github.com/symonk/Release-Management

### What we need

- Apache Jmeter (http://jmeter.apache.org/download_jmeter.cgi)
- Firefox or Chrome
- Something to login too (my localhost web application)

**note:** JMETER is a powerful tool and is it not advised to use it against any application or website when you do not have consent to do so.

The first thing we want to do is, have our login form open in chrome and open the chrome developer console (press F12).  The chrome has a "Network" tab in it and this is primarily where we want to be looking.  Just to test, submit your login form with bad data and pay attention to the networking tab in chrome, we will see some sort of **POST** request 


![Failed Login](https://github.com/symonk/symonk.github.io/tree/master/img/failedLogin.JPG)

As you can see from my above image ive attempted a failed login, which has sent an HTTP POST request to the server, in my instance I have redirected the user to login?error which provides more information about the bad credentials, this is why I am returning a status code 302 (Redirection).  However it is highly likely you will see a 200 - OK, or possibly even a 4xx status code.  Anyway, we now know a little about the submission POST request.

Next up is to load up JMETER, let's just launch it using the GUI version as this will be a simple test, again to note if you are performing load testing on your application and you want to run a heavy load, the thread count/ loop will tend to break the GUI as it uses alot more resources, for this look into running your test from the command line. (https://www.blazemeter.com/blog/5-ways-launch-jmeter-test-without-using-jmeter-gui).  

Here is where it gets relatively simple in JMETER you will see two headings on the left hand side, Test Plan and WorkBench.  This is where we will structure our tests.  The first thing we want to add is a Thread Group  under the Test Plan header, right click Test Plan -> Add -> Thread(s) Users -> Thread Group.  The Thread group is used to set how many executions and or users we want to use.  As this is a simple test, we will just be looping once and using one user.Setup is pictured below:

![Thread Setup](https://github.com/symonk/symonk.github.io/tree/master/img/1.JPG)

As you can see, we can edit the name to something more suitable, however in this example we will be just looping once with one user.  The next step is to get some HTTP Request recording up and running to see what is actually going when we are navigating our web application, this is the most tricky part of the entire guide and its still relatively basic. 

Just like we added a Thread Group to the test plan, we now want to add a Recording Controller to the Thread Group, in my case its called Users now.  Right click the thread group ->  Add -> Logic Controller -> Recording Controller.

Secondly, add **to the workbench** a HTTP(s) Test Script Recorder.  This will be running with our proxy to capture HTTP requests and list them under our Recording Controller.  Now you will be able to Start this Script Recorder via clicking on it but first, lets do some configuration.  We will need:

- Certificate installed (Generated by the Script Recorder/JMETER)
- Proxy Configuration

Click on the Script Recorder under workbench and give it an appropriate name, I have used "Request Script Recorder", also worth noting if you haven't change the name of the Recording controller too (in Test Plan), I have used "My Requests".

Set the **Port** for your Script Recorder, I will be using port: 8181.  It is important to remember this when we are configuring our browser to run using our proxy.  Once done, simply press **Start** (in the Script Record, **NOT** on the entire JMETER test.  **note** - The port cannot be in use, since I am running a localhost web application on port 8080, its not usable.

Upon pressing start, you will be presented with a certificate popup which is *automatically* generated by JMETER.  

![Recording Setup](https://github.com/symonk/symonk.github.io/tree/master/img/2.JPG)

This will have left a CERTIFICATE in your JMETER/bin directory.  Install this certificate using Firefox / Chrome, I won't be explaining this throughout this tutorial but it is pretty simple.

![Certificate](https://github.com/symonk/symonk.github.io/tree/master/img/3.JPG)

Once your certificate has been installed, we need to configure our proxy.  I'm going to be using firefox for this but if you want to use chrome, it is similar in process.

Launch firefox (remember the port your script recorder is running on? 8181). 

1. Go into Firefox Options (top right menu icon, then select Options).
2. On the left handside menu that appears, select Advanced and select the Network tab
3. Under connection, press Settings, you will be presented with a popup
4. Select Manual Proxy configuration
5. Set localhost and port to match your listener, e.g 8181

![Certificate](https://github.com/symonk/symonk.github.io/tree/master/img/4.JPG)

Now we have that configured, go on ahead and hit your login box again from Firefox (The reason I started on chrome and now am using firefox is to add a bit of variance to the guide.  Once youve loaded your page in firefox, look at your JMETER Requests (expand out the tree) you will likely have a number of GET requests listed there for things like page styling etc.  The important one is your /login one.  Next successfully login to your form, you will see more requests in JMETER.  The important one here is the POST request.  You can filter out all the other useless (for this scenario) ones by deleting them.  

![Useful Requests](https://github.com/symonk/symonk.github.io/tree/master/img/5.JPG)

Now simply, drag these requests out from the Request controller and drop them on the actual Thread Group.  Next up we want to add some assertions to ensure evertything is actually working. So what type of assertions do we need? for this example I'm going to be asserting just against the plain HTML which is returned,  so for my login GET request (grabbing the login page).  

Add -> Assertion -> Response Assertion -> Here Im going to check the "Sign In" text is contained in the HTML response.

For the POST method, im going to add a similar assertion, however im going to ensure "Welcome: Simon" is contained in the HTML response.

Finally add a listener into our test plan (typically you should add these at the Work bench level, but for the purpose of this guide, we will just add it under our test plan.  

Add -> Listener -> View Results in Tree - Again you can rename this accordingly, here is our final test Setup:

![Final Setup](https://github.com/symonk/symonk.github.io/tree/master/img/6.JPG)

and thats it!, you can finally execute your test and check your test listener to see the results.  The above guide applies to anything with navigating around a web application via HTTP requests and can be applied to create a wealth of tests, but we have just touched the surface on JMETER, there is so much more available. 
